{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/LercDecoder.js","../node_modules/@arcgis/core/layers/ElevationLayer.js","../node_modules/@arcgis/core/core/workers/WorkerHandle.js"],"names":["r","e","constructor","super","strategy","this","scheduler","decode","t","byteLength","invoke","buffer","options","Promise","resolve","getTransferList","Map","w","getLogger","x","f","v","y","g","u","m","copyright","heightModelInfo","path","opacity","operationalLayerType","sourceJSON","type","url","version","_lercDecoder","n","get","instance","ref","set","S","normalizeCtorArgs","destroy","delete","j","constructed","warn","declaredClass","readVersion","currentVersion","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","supportsData","validateItem","typeKeywords","length","toLowerCase","a","expectedType","then","_fetchImageService","fetchTile","o","i","s","responseType","l","noDataValue","returnFileInfo","_fetchTileAvailability","c","getTileUrl","data","values","pixelData","width","height","maxZError","fileInfo","minValue","maxValue","tilemapCache","supportsBlankTile","parsedUrl","query","blankTile","ElevationQuery","p","createSampler","fetchAvailability","ssl","replace","read","origin","json","source","prototype","readOnly","d","String","origins","write","service","value","h","T","_mainMethod","_listeners","_promise","_thread","hasInitialize","broadcast","_connectListener","close","catch","error","on","removed","eventName","callback","threadHandle","push","remove","invokeMethod","transferList","reject","all"],"mappings":"wUAIkE,MAAMA,UAAUC,IAAEC,YAAYD,GAAGE,MAAM,aAAa,UAAUF,EAAE,CAACG,SAAS,cAAcC,KAAKC,UAAUL,EAAEM,OAAON,EAAED,EAAEQ,GAAG,OAAOP,GAAG,IAAIA,EAAEQ,WAAWJ,KAAKK,OAAO,CAACC,OAAOV,EAAEW,QAAQZ,GAAGQ,GAAGK,QAAQC,QAAQ,MAAMC,gBAAgBd,GAAG,MAAM,CAACA,EAAEU,SAAS,MAAMH,EAAE,IAAIQ,ICA22B,MAAMC,EAAET,IAAEU,UAAU,8BAA8B,IAAIC,EAAE,cAAcC,YAAEC,YAAEC,YAAEC,YAAEC,YAAEC,UAAQvB,eAAeD,GAAGE,SAASF,GAAGI,KAAKqB,UAAU,KAAKrB,KAAKsB,gBAAgB,KAAKtB,KAAKuB,KAAK,KAAKvB,KAAKwB,QAAQ,EAAExB,KAAKyB,qBAAqB,mCAAmCzB,KAAK0B,WAAW,KAAK1B,KAAK2B,KAAK,YAAY3B,KAAK4B,IAAI,KAAK5B,KAAK6B,QAAQ,KAAK7B,KAAK8B,aDAtrC,SAAWlC,GAAG,IAAImC,EAAE5B,EAAE6B,IAAIpC,GAAG,OAAOmC,IAAIA,EAAE,CAACE,SAAS,IAAItC,EAAEC,GAAGsC,IAAI,GAAG/B,EAAEgC,IAAIvC,EAAEmC,MAAMA,EAAEG,IAAIH,EAAEE,SCAymCG,GAAIC,kBAAkBzC,EAAED,GAAG,MAAM,iBAAiBC,EAAE,CAACgC,IAAIhC,KAAKD,GAAGC,EAAE0C,WDAnqC,SAAW1C,GAAG,GAAG,MAAMA,EAAE,OAAO,MAAMD,EAAEC,EAAEK,UAAU8B,EAAE5B,EAAE6B,IAAIrC,GAAGoC,KAAKA,EAAEG,KAAK,IAAIH,EAAEE,SAASK,UAAUnC,EAAEoC,OAAO5C,KCAgkC6C,CAAExC,KAAK8B,cAAc9B,KAAK8B,aAAa,KAAiB,aAAClC,GAAGI,KAAKyC,aAAa7B,EAAE8B,KAAM,GAAE1C,KAAK2C,+DAA2E,gBAAgB,aAAC/C,GAAGI,KAAKyC,aAAa7B,EAAE8B,KAAM,GAAE1C,KAAK2C,+DAA2E,gBAAIC,YAAYhD,EAAED,GAAG,IAAIQ,EAAER,EAAEkD,eAAe,OAAO1C,IAAIA,EAAE,KAAKA,EAAE2C,KAAKlD,GAAG,MAAMO,EAAER,YAAEC,GAAGA,EAAEmD,OAAO,KAAK,OAAO/C,KAAKgD,oBAAoBhD,KAAKiD,eAAe,CAACC,eAAe,CAAC,iBAAiBC,cAAa,EAAGC,aAAaxD,IAAI,IAAI,IAAID,EAAE,EAAEA,EAAEC,EAAEyD,aAAaC,OAAO3D,IAAI,GAAG,uBAAuBC,EAAEyD,aAAa1D,GAAG4D,cAAc,OAAM,EAAG,MAAM,IAAIC,IAAE,iCAAiC,iEAAiE,CAAC7B,KAAK,gBAAgB8B,aAAa,uCAAuC7D,GAAG8D,MAAM,IAAI1D,KAAK2D,mBAAmBxD,KAAK,IAAIH,KAAK2D,mBAAmBxD,MAAMK,QAAQC,QAAQT,MAAM4D,UAAUhE,EAAEO,EAAE0D,EAAEC,GAAG,MAAMC,EAAEpE,aAAGmE,EAAEA,GAAG,CAACf,OAAO,OAAOA,QAAQe,EAAEf,OAAOe,EAAEf,OAAOhB,cAAIgB,OAAOS,EAAE,CAACQ,aAAa,eAAejB,OAAOgB,GAAGE,EAAE,CAACC,YAAYJ,EAAEI,YAAYC,gBAAe,GAAI,OAAOnE,KAAK8C,OAAOY,MAAM,IAAI1D,KAAKoE,uBAAuBxE,EAAEO,EAAE0D,EAAEC,KAAKJ,MAAM,IAAIW,kBAAErE,KAAKsE,WAAW1E,EAAEO,EAAE0D,GAAGL,KAAKE,MAAM9D,GAAGI,KAAK8B,aAAa5B,OAAON,EAAE2E,KAAKN,EAAEF,KAAKL,MAAM9D,IAAC,CAAI4E,OAAO5E,EAAE6E,UAAUC,MAAM9E,EAAE8E,MAAMC,OAAO/E,EAAE+E,OAAOC,UAAUhF,EAAEiF,SAASD,UAAUV,YAAYtE,EAAEsE,YAAYY,SAASlF,EAAEkF,SAASC,SAASnF,EAAEmF,aAAaT,WAAW1E,EAAED,EAAEQ,GAAG,MAAM0D,GAAG7D,KAAKgF,cAAchF,KAAKiF,kBAAkBnB,EAAEG,YAAE,IAAIjE,KAAKkF,UAAUC,MAAMC,WAAWvB,GAAG,OAAO,MAAO,GAAE7D,KAAKkF,UAAU3D,aAAa3B,KAAKD,KAAKQ,IAAI2D,EAAE,IAAIA,EAAE,KAAyB,qBAAClE,EAAED,GAAG,MAAM0F,eAAelF,SAAS,gCAA2C,OAALmF,YAAE3F,IAAU,IAAIQ,GAAGgF,MAAMnF,KAAKJ,EAAED,GAA+B,6BAACC,EAAED,GAAG,MAAM0F,eAAelF,SAAS,gCAA2C,OAALmF,YAAE3F,IAAU,IAAIQ,GAAGoF,cAAcvF,KAAKJ,EAAED,GAAGyE,uBAAuBxE,EAAED,EAAEQ,EAAE0D,GAAG,OAAO7D,KAAKgF,aAAahF,KAAKgF,aAAaQ,kBAAkB5F,EAAED,EAAEQ,EAAE0D,GAAGrD,QAAQC,QAAQ,WAAmC,yBAACb,GAAG,GAAGI,KAAK0B,WAAW,OAAO1B,KAAK0B,WAAW,MAAM/B,EAAE,CAACwF,MAAM,CAACpE,EAAE,UAAUf,KAAKkF,UAAUC,OAAOnB,aAAa,OAAOjB,OAAOnD,GAAGO,QAAQkE,kBAAErE,KAAKkF,UAAU3D,KAAK5B,GAAGQ,EAAEsF,MAAMzF,KAAK4B,IAAI5B,KAAK4B,IAAI8D,QAAQ,UAAU,WAAW1F,KAAK0B,WAAWvB,EAAEoE,KAAKvE,KAAK2F,KAAKxF,EAAEoE,KAAK,CAACqB,OAAO,UAAUhE,IAAI5B,KAAKkF,cAActF,YAAE,CAACiE,YAAE,CAACgC,KAAK,CAACF,KAAK,CAACG,OAAO,qBAAqBhF,EAAEiF,UAAU,iBAAY,GAAQnG,YAAE,CAACiE,YAAE,CAACmC,UAAS,EAAGrE,KAAKsE,OAAKnF,EAAEiF,UAAU,uBAAkB,GAAQnG,YAAE,CAACiE,YAAE,CAAClC,KAAKuE,OAAOL,KAAK,CAACM,QAAQ,CAAC,YAAY,CAACR,MAAK,EAAGS,OAAM,IAAKT,MAAK,MAAO7E,EAAEiF,UAAU,YAAO,GAAQnG,YAAE,CAACiE,YAAE,CAAClC,KAAK,CAAC,OAAO,WAAWb,EAAEiF,UAAU,gBAAW,GAAQnG,YAAE,CAACiE,YAAE,CAACgC,KAAK,CAACF,MAAK,EAAGS,OAAM,EAAGD,QAAQ,CAACE,QAAQ,CAACV,MAAK,EAAGS,OAAM,GAAI,cAAc,CAACT,MAAK,EAAGS,OAAM,GAAI,eAAe,CAACT,MAAK,EAAGS,OAAM,QAAStF,EAAEiF,UAAU,WAAW,MAAMnG,YAAE,CAACiE,YAAE,CAACgC,KAAK,CAACF,MAAK,EAAGS,OAAM,EAAGD,QAAQ,CAACE,QAAQ,CAACV,MAAK,EAAGS,OAAM,GAAI,cAAc,CAACT,MAAK,EAAGS,OAAM,GAAI,eAAe,CAACT,MAAK,EAAGS,OAAM,QAAStF,EAAEiF,UAAU,WAAW,MAAMnG,YAAE,CAACiE,YAAE,CAACgC,KAAK,CAACF,MAAK,EAAGS,OAAM,EAAGD,QAAQ,CAAC,eAAe,CAACR,MAAK,EAAGS,OAAM,QAAStF,EAAEiF,UAAU,eAAU,GAAQnG,YAAE,CAACiE,YAAE,CAAClC,KAAK,CAAC,uCAAuCb,EAAEiF,UAAU,4BAAuB,GAAQnG,YAAE,CAACiE,eAAK/C,EAAEiF,UAAU,kBAAa,GAAQnG,YAAE,CAACiE,YAAE,CAACgC,KAAK,CAACF,MAAK,GAAIW,MAAM,YAAYN,UAAS,KAAMlF,EAAEiF,UAAU,YAAO,GAAQnG,YAAE,CAACiE,YAAE0C,MAAIzF,EAAEiF,UAAU,WAAM,GAAQnG,YAAE,CAACiE,eAAK/C,EAAEiF,UAAU,eAAU,GAAQnG,YAAE,CAACkE,YAAE,UAAU,CAAC,oBAAoBhD,EAAEiF,UAAU,cAAc,MAAMjF,EAAElB,YAAE,CAACmE,YAAE,+BAA+BjD,GAAG,IAAI0F,EAAE1F,EAAiB0F,a,iCCJj+J,sFAIkP,MAAMD,EAAEpG,IAAEU,UAAU,kCAAkC,MAAMkB,EAAElC,YAAYD,EAAEO,EAAER,EAAEoE,EAAE,IAAI/D,KAAKyG,YAAYtG,EAAEH,KAAK0G,WAAW,GAAG1G,KAAK2G,SAAS9C,YAAEjE,EAAE,IAAImE,EAAE9D,UAAUN,IAAI+D,MAAM9D,IAAI,QAAG,IAASI,KAAK4G,QAAQ,CAAC5G,KAAK4G,QAAQhH,EAAEI,KAAK2G,SAAS,KAAK5C,EAAE8C,eAAe7G,KAAK8G,UAAU,GAAG,cAAc,IAAI,MAAMlH,KAAKI,KAAK0G,WAAW1G,KAAK+G,iBAAiBnH,QAAQA,EAAEoH,WAAWhH,KAAK2G,SAASM,OAAO9G,GAAGoG,EAAEW,MAAO,wBAAuBtH,aAAaO,OAAOgH,GAAGhH,EAAE2D,GAAG,MAAMD,EAAE,CAACuD,SAAQ,EAAGC,UAAUlH,EAAEmH,SAASxD,EAAEyD,aAAa,MAAM,OAAOvH,KAAK0G,WAAWc,KAAK3D,GAAG7D,KAAK+G,iBAAiBlD,GAAGlE,aAAG,KAAKkE,EAAEuD,SAAQ,EAAGrD,YAAE/D,KAAK0G,WAAW7C,GAAG7D,KAAK4G,SAAShH,YAAEiE,EAAE0D,eAAe1D,EAAE0D,aAAaE,YAAYnF,UAAUtC,KAAK4G,UAAU5G,KAAK4G,QAAQI,QAAQhH,KAAK4G,QAAQ,MAAM5G,KAAK2G,SAAS,KAAKtG,OAAOT,EAAEO,GAAG,OAAOH,KAAK0H,aAAa1H,KAAKyG,YAAY7G,EAAEO,GAAGuH,aAAa9H,EAAEO,EAAER,GAAG,GAAGK,KAAK4G,QAAQ,CAAC,MAAM7C,EAAE/D,KAAKU,gBAAgBP,EAAEP,GAAG,OAAOI,KAAK4G,QAAQvG,OAAOT,EAAEO,EAAE,CAACwH,aAAa5D,EAAEhB,OAAOpD,IAAI,OAAOK,KAAK2G,SAAS3G,KAAK2G,SAASjD,MAAM,KAAKI,YAAEnE,GAAGK,KAAK0H,aAAa9H,EAAEO,EAAER,MAAMa,QAAQoH,OAAO,MAAMd,UAAUlH,EAAEO,GAAG,OAAOH,KAAK4G,QAAQpG,QAAQqH,IAAI7H,KAAK4G,QAAQE,UAAU3G,EAAEP,IAAI8D,MAAM,SAAS1D,KAAK2G,SAAS3G,KAAK2G,SAASjD,MAAM,IAAI1D,KAAK8G,UAAUlH,EAAEO,KAAKK,QAAQoH,SAAoB,cAAG,OAAO5H,KAAK2G,SAASI,iBAAiBnH,GAAGI,KAAK4G,SAAS5G,KAAK4G,QAAQO,GAAGvH,EAAEyH,UAAUzH,EAAE0H,UAAU5D,MAAMvD,IAAIP,EAAEwH,UAAUxH,EAAE2H,aAAapH","file":"static/js/29.7fa59e73.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{WorkerHandle as e}from\"../../core/workers/WorkerHandle.js\";class r extends e{constructor(e){super(\"LercWorker\",\"_decode\",e,{strategy:\"dedicated\"}),this.scheduler=e}decode(e,r,t){return e&&0!==e.byteLength?this.invoke({buffer:e,options:r},t):Promise.resolve(null)}getTransferList(e){return[e.buffer]}}const t=new Map;function n(e){let n=t.get(e);return n||(n={instance:new r(e),ref:0},t.set(e,n)),++n.ref,n.instance}function s(e){if(null==e)return;const r=e.scheduler,n=t.get(r);n&&--n.ref<=0&&(n.instance.destroy(),t.delete(r))}export{n as acquireDecoder,s as releaseDecoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import t from\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{reader as i}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import a from\"../core/Error.js\";import{objectToQuery as l}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{createAbortController as n,throwIfAborted as p}from\"../core/promiseUtils.js\";import c from\"../request.js\";import m from\"./Layer.js\";import{MultiOriginJSONMixin as u}from\"../core/MultiOriginJSONSupport.js\";import d from\"../geometry/HeightModelInfo.js\";import{url as h}from\"./support/commonProperties.js\";import{OperationalLayer as y}from\"./mixins/OperationalLayer.js\";import{ArcGISService as v}from\"./mixins/ArcGISService.js\";import{PortalLayer as g}from\"./mixins/PortalLayer.js\";import{ArcGISCachedService as f}from\"./mixins/ArcGISCachedService.js\";import{acquireDecoder as S,releaseDecoder as j}from\"./support/LercDecoder.js\";const w=t.getLogger(\"esri.layers.ElevationLayer\");let x=class extends(f(v(y(g(u(m)))))){constructor(...e){super(...e),this.copyright=null,this.heightModelInfo=null,this.path=null,this.opacity=1,this.operationalLayerType=\"ArcGISTiledElevationServiceLayer\",this.sourceJSON=null,this.type=\"elevation\",this.url=null,this.version=null,this._lercDecoder=S()}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}destroy(){j(this._lercDecoder),this._lercDecoder=null}set minScale(e){this.constructed&&w.warn(`${this.declaredClass}.minScale support has been removed (since 4.5)`)}get minScale(){}set maxScale(e){this.constructed&&w.warn(`${this.declaredClass}.maxScale support has been removed (since 4.5)`)}get maxScale(){}readVersion(e,r){let t=r.currentVersion;return t||(t=9.3),t}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"],supportsData:!1,validateItem:e=>{for(let r=0;r<e.typeKeywords.length;r++)if(\"elevation 3d layer\"===e.typeKeywords[r].toLowerCase())return!0;throw new a(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}' \",{type:\"Image Service\",expectedType:\"Image Service Elevation 3D Layer\"})}},e).then((()=>this._fetchImageService(t)),(()=>this._fetchImageService(t)))),Promise.resolve(this)}fetchTile(e,t,o,i){const s=r((i=i||{signal:null}).signal)?i.signal:i.signal=n().signal,a={responseType:\"array-buffer\",signal:s},l={noDataValue:i.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,o,i))).then((()=>c(this.getTileUrl(e,t,o),a))).then((e=>this._lercDecoder.decode(e.data,l,s))).then((e=>({values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue})))}getTileUrl(e,r,t){const o=!this.tilemapCache&&this.supportsBlankTile,i=l({...this.parsedUrl.query,blankTile:!o&&null});return`${this.parsedUrl.path}/tile/${e}/${r}/${t}${i?\"?\"+i:\"\"}`}async queryElevation(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");p(r);return(new t).query(this,e,r)}async createElevationSampler(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");p(r);return(new t).createSampler(this,e,r)}_fetchTileAvailability(e,r,t,o){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,r,t,o):Promise.resolve(\"unknown\")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const r={query:{f:\"json\",...this.parsedUrl.query},responseType:\"json\",signal:e},t=await c(this.parsedUrl.path,r);t.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=t.data,this.read(t.data,{origin:\"service\",url:this.parsedUrl})}};e([o({json:{read:{source:\"copyrightText\"}}})],x.prototype,\"copyright\",void 0),e([o({readOnly:!0,type:d})],x.prototype,\"heightModelInfo\",void 0),e([o({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],x.prototype,\"path\",void 0),e([o({type:[\"show\",\"hide\"]})],x.prototype,\"listMode\",void 0),e([o({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"minScale\",null),e([o({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"maxScale\",null),e([o({json:{read:!1,write:!1,origins:{\"web-document\":{read:!1,write:!1}}}})],x.prototype,\"opacity\",void 0),e([o({type:[\"ArcGISTiledElevationServiceLayer\"]})],x.prototype,\"operationalLayerType\",void 0),e([o()],x.prototype,\"sourceJSON\",void 0),e([o({json:{read:!1},value:\"elevation\",readOnly:!0})],x.prototype,\"type\",void 0),e([o(h)],x.prototype,\"url\",void 0),e([o()],x.prototype,\"version\",void 0),e([i(\"version\",[\"currentVersion\"])],x.prototype,\"readVersion\",null),x=e([s(\"esri.layers.ElevationLayer\")],x);var T=x;export default T;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../maybe.js\";import t from\"../Logger.js\";import{makeHandle as r}from\"../handleUtils.js\";import{remove as s}from\"../arrayUtils.js\";import{throwIfAborted as i}from\"../promiseUtils.js\";import{open as o}from\"./workers.js\";const h=t.getLogger(\"esri.core.workers.WorkerHandle\");class n{constructor(e,t,r,s={}){this._mainMethod=t,this._listeners=[],this._promise=o(e,{...s,scheduler:r}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,s.hasInitialize&&this.broadcast({},\"initialize\");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>h.error(`Failed to initialize ${e} worker: ${t}`)))}on(t,i){const o={removed:!1,eventName:t,callback:i,threadHandle:null};return this._listeners.push(o),this._connectListener(o),r((()=>{o.removed=!0,s(this._listeners,o),this._thread&&e(o.threadHandle)&&o.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,r){if(this._thread){const s=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:s,signal:r})}return this._promise?this._promise.then((()=>(i(r),this.invokeMethod(e,t,r)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}export{n as WorkerHandle};\n"],"sourceRoot":""}